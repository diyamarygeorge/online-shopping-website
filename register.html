<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Register — Demo Shop</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* small Material-like styles */
    body { background:#f5f7fb; }
    .material-card { border-radius:12px; box-shadow: 0 8px 24px rgba(12,20,40,0.06); }
    .form-input { border-radius:8px; box-shadow: inset 0 2px 6px rgba(0,0,0,0.03); }
    .material-btn { border-radius: 28px; padding: 8px 18px; box-shadow: 0 6px 12px rgba(0,0,0,0.06); }
    .snackbar { visibility:hidden; min-width:200px; background:#323232; color:#fff; text-align:center; border-radius:6px; padding:10px 14px; position:fixed; left:50%; transform:translateX(-50%); bottom:30px; z-index:9999; font-size:14px; }
    .snackbar.show { visibility:visible; animation: fadein .25s, fadeout .5s 2.4s; }
    @keyframes fadein{ from{opacity:0;bottom:10px} to{opacity:1;bottom:30px} }
    @keyframes fadeout{ from{opacity:1;bottom:30px} to{opacity:0;bottom:10px} }
  </style>
</head>
<body>
  <nav class="navbar navbar-light bg-white shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">Shop</a>
    </div>
  </nav>

  <main class="container py-5">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="card p-4 material-card">
          <h4 class="mb-3">Create account</h4>
          <form id="registerForm" novalidate>
            <div class="mb-3">
              <label class="form-label">Full name</label>
              <input id="name" class="form-control form-input" required />
            </div>
            <div class="mb-3">
              <label class="form-label">Email</label>
              <input id="email" type="email" class="form-control form-input" required />
            </div>
            <div class="mb-3">
              <label class="form-label">Password</label>
              <input id="password" type="password" class="form-control form-input" required />
            </div>
            <div class="mb-3">
              <label class="form-label">Confirm Password</label>
              <input id="confirmPassword" type="password" class="form-control form-input" required />
            </div>

            <button class="btn btn-primary material-btn w-100" type="submit">Register</button>
            <p class="mt-3 small">Already have account? <a href="login.html">Login</a></p>
          </form>
        </div>
      </div>
    </div>
  </main>

  <div id="snackbar" class="snackbar"></div>

  <script>
    // simple snackbar
    function showSnackbar(msg){
      const s = document.getElementById('snackbar');
      s.textContent = msg;
      s.classList.add('show');
      setTimeout(()=> s.classList.remove('show'), 2600);
    }

    // localStorage helpers
    const LS_USERS = 'users';
    function getUsers(){ try { return JSON.parse(localStorage.getItem(LS_USERS) || '[]'); } catch { return []; } }
    function saveUsers(arr){ localStorage.setItem(LS_USERS, JSON.stringify(arr)); }

    // registration logic
    document.getElementById('registerForm').addEventListener('submit', function(e){
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim().toLowerCase();
      const password = document.getElementById('password').value;
      const confirm = document.getElementById('confirmPassword').value;

      // basic validation
      if(!name || !email || !password || !confirm) return showSnackbar('Please fill all fields');
      const emailRe = /^[^@\s]+@[^@\s]+\.[^@\s]+$/;
      if(!emailRe.test(email)) return showSnackbar('Please enter a valid email');
      if(password.length < 6) return showSnackbar('Password must be at least 6 characters');
      if(password !== confirm) return showSnackbar('Passwords do not match');

      const users = getUsers();
      if(users.some(u => u.email === email)) return showSnackbar('Email already registered');

      // create user object (no hashing — demo only)
      const id = users.length ? Math.max(...users.map(u=>u.id)) + 1 : 1;
      const newUser = { id, name, email, password, isAdmin: false };
      users.push(newUser);
      saveUsers(users);

      showSnackbar('Registration successful. Redirecting to Login...');
      setTimeout(() => { window.location.href = 'login.html'; }, 900);
    });

    // If users not present, add a default admin (so you can test later)
    (function ensureAdmin(){
      const users = getUsers();
      if(!users.some(u => u.email === 'admin@gmail.com')){
        users.push({ id: users.length ? Math.max(...users.map(u=>u.id)) + 1 : 1, name: 'Admin', email: 'admin@gmail.com', password: 'admin123', isAdmin: true });
        saveUsers(users);
      }
    })();
  </script>
</body>
</html>
